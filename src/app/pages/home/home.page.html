<app-logged-in-header [isHome]=true></app-logged-in-header>

<ion-content>

    <div *ngIf="currentState == 'request'">
        <div *ngIf="currentRequestDataLoaded; else loading" class="ion-padding">

            <app-request-form *ngIf="!pendingRequest; else pendingRequestInformation" [user]="me"></app-request-form>
            <ng-template #pendingRequestInformation>
                <h2>Your request has been received!</h2>
                <div *ngIf="pendingRequest.completed_by_id == null" id="pending-request-area">

                    <p>Please wait while we connect you with a local Jengu.</p>
                    <p>Checking for a local Jengu in...</p>

                    <div class="circle__box" [class.animating]="loadingAnimating">
                        <div class="circle__wrapper circle__wrapper--right">
                            <div class="circle__whole circle__right"></div>
                        </div>
                        <div class="circle__wrapper circle__wrapper--left">
                            <div class="circle__whole circle__left"></div>
                        </div>
                        <div id="refresh-time">{{nextRefreshTime}}</div>
                    </div>

                    <div class="submit-wrapper">
                        <ion-button (click)="cancelRequest(pendingRequest)" color="danger">Cancel Request</ion-button>
                    </div>

                </div>
            </ng-template>

        </div>
        <ng-template #loading>
        </ng-template>
    </div>

    <div *ngIf="currentState == 'deliver'" id="deliver">
        <app-delivery-map *ngIf="currentPosition" [startingLatitude]="currentPosition.coords.latitude" [startingLongitude]="currentPosition.coords.longitude"></app-delivery-map>
    </div>

</ion-content>
